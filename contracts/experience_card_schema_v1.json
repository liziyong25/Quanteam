{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://quant-eam.local/contracts/experience_card_schema_v1.json",
  "title": "experience_card_v1",
  "type": "object",
  "additionalProperties": true,
  "$comment": "Registry Experience Card (immutable base record). Cards are created only from Gate PASS runs and reference dossier + gate_results evidence. Future evolution is event-sourced via cards/<card_id>/events.jsonl.",
  "required": [
    "schema_version",
    "card_id",
    "created_at",
    "title",
    "status",
    "primary_run_id",
    "evidence",
    "policy_bundle_id"
  ],
  "properties": {
    "schema_version": {
      "const": "experience_card_v1",
      "description": "Schema version discriminator. Must be exactly 'experience_card_v1'."
    },
    "extensions": {
      "type": "object",
      "additionalProperties": true,
      "description": "Forward-compatible extension area. Must not be used to override governance/policies."
    },
    "card_id": { "type": "string" },
    "created_at": { "type": "string", "format": "date-time" },
    "title": { "type": "string" },
    "status": {
      "type": "string",
      "enum": ["draft", "challenger", "champion", "retired"],
      "description": "Base status at creation time. Subsequent transitions are recorded in events.jsonl."
    },
    "primary_run_id": { "type": "string" },
    "policy_bundle_id": {
      "type": "string",
      "description": "Read-only policy bundle reference (by id)."
    },
    "evidence": {
      "type": "object",
      "additionalProperties": true,
      "required": ["run_id", "dossier_path", "gate_results_path", "key_artifacts"],
      "properties": {
        "run_id": { "type": "string" },
        "dossier_path": { "type": "string" },
        "gate_results_path": { "type": "string" },
        "key_artifacts": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string" },
          "description": "Artifact paths (relative or absolute) that form the evidence chain (must point into dossier)."
        }
      }
    },
    "applicability": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "universe_hint": { "type": "string" },
        "freq": { "type": "string" },
        "horizon_hint": { "type": "string" }
      }
    },
    "known_failure_modes": {
      "type": "array",
      "items": { "type": "string" }
    }
  }
}

